Todo
----
* Performance bottlenecks are the html concat in dom.js and the painting. Use canvas.
* Fix helpers and sort out all the loops.
